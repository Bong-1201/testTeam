test09 실습 문제 풀이 및 정리

html에서 데이터 보내고 받는거
jsp사용해서(서버) 
form의 디폴트값이 POST 제외하면 대부분 GET
DB대신하는 DAO가 존재
문법 뭘 쓰던지 onClick에 연결 되어있어야함 - 이벤트 연결
confirm() - 한번 더 정확하게 물어봄
var ans confirm() - confirm에 대한 답변을 들음

if(ans==true)
document에 있는 test를 submit 진행 해줘
//회원가입 진행 - form 태그 내부에 있는 action의 값이 signup이 될수있게
그 상태로 submit 진행
else{
return;

로그인 하듯이 똑같은 데이터를 진행하니까
회원가입도 submit 로그인처럼 진행 - form 내부에 있는거 써야되니까
어떤 버튼을 누르냐에 따라 무슨 행동을 하는지 알고있으면 좋음

★   <input type="hidden" name="action" value="login"> - 자주 쓰이는 틀


form 써야되니까 이름을 붙여둠 name="test"라고



if(request.getMethod().equals("POST")){
	if(request.getparameter~~ - if(action값이 login이니?)
	MemberVO data=mDAO.selectOne(mVO);
	if(data != null){
		out.println("alert('"+data.getMid()+"님, 로그인 성공!');");
	}
	else{
		out.println("alert('로그인 실패...');");
	}
	else if(action값이 signup) - > mVO받아서 flag true라면, 
	회원가입
}
여기에 action값이 없으니까 컨트롤러 했던거 처럼 넣으면됌

3,4번 라인이 자바로 바꾸면 new~~뭐시기 하는거 현재 데이터 유지가 안됨

-------------------------------------------------------------------------------------------------------------------------------------------------------------
day38
test01 - 에러페이지

exception 객체 사용하려면 트라이캐치 있었어야함
exception 객체가 선언되어 있지 않다고 빨간줄
isErrorPage="true" - 에러 페이지 안내

-------------------------------------------------------------------------------------------------------------------------------------------------------------
test02 - 일부러 만드는 에러

errorPage="test01.jsp" -> 에러페이지 발생하면 이쪽으로 가 라고 표시해둔거
페이지 소스코드 보면 만들어둔 코드가 나옴

-------------------------------------------------------------------------------------------------------------------------------------------------------------
test03 - 사용자가 많은 리퀘스트 보내줄수 있음

데이터를 많이 보낼꺼니까 test로 보냄

셀렉박스나 체크박스 보낼꺼



실행했을때 test04 없으면 400대 에러 - 웹페이지가 없으니까




-------------------------------------------------------------------------------------------------------------------------------------------------------------
test 04

request.getparameterValues - 사용하면 체크박스의 여러개 가져올수 있음

for(int i=0;i<전달받은 데이터 개수만큼;i++){
			화면에 <li>v</li> 출력해줘
		}




*인코딩 이슈 - 한글깨지는거
-------------------------------------------------------------------------------------------------------------------------------------------------------------
test 05 

사용자가 무언가를 요청하면 요청한 값을 어떻게 받아오는지
responce 응답 관련 내장 객체

정보를 전달할수 있는 form 두개
하나는 - 테스트 06으로 보내고
하나는 - 07로 보냄

forward 액션으로 데이터를 전송하기 <br>

버튼 눌러야 전송되니까 submit


response.sendRedirect()로 데이터를 전송하기


웹화면-
msg에 msg

-------------------------------------------------------------------------------------------------------------------------------------------------------------
test 08 결과 페이지

<h1>msg(전달받은 메세지) : <%request.getparameter("msg") %> </h1>
<h1>test -> 추가될 데이터 테스트



첫페이지에 밀어넣은거랑
추가로 적은거를 받아옴

타이틀은 결과라고 나왔는데 url이 test06이라고 나왔음


-------------------------------------------------------------------------------------------------------------------------------------------------------------
test06

<jsp:forward page=""></jsp:forward> - 어느 페이지로 갈꺼니? 갈곳 알려주면 됨 test08이라고

forward 액션 태그를 활용하면
처음에 요청했던(전송했던) 데이터들이 유지되고
URL이 변경되지않음 - > (처리된것처럼 동작)
진짜로 새로운 요청이 된것이아니라,
새로운 요청이(추가된 요청이) 처리된것처럼 동작

별도의 새 요청이아니라 내부적으로 요청 처리가 되는거임



-------------------------------------------------------------------------------------------------------------------------------------------------------------
test 07 - response.sendRedirect

response.sendRedirect - 내장객체를 사용하는거라 자바를 사용해야함


forward액션과 달리 response.sendRedirect는 처음에 전송한(요청한) 데이터가 유지되지 않음
URL이 변경됨
== 새로운 요청이 처리된다
이전의 요청은 까먹게됨

response.sendRedirect("test") <- 이 안에 데이터는 있음

-------------------------------------------------------------------------------------------------------------------------------------------------------------
필기

데이터 유지해야되면 - forward
데이터 유지 안할라면 - response.sendRedirect

상황에 맞게 선택해서 쓰면 댐



-------------------------------------------------------------------------------------------------------------------------------------------------------------
test09
쇼핑몰 만드는 틀

우선 로그인 해야 뭘 하니까 로그인부터

form action="test10.jsp" -> test10으로 보낼꺼야





-------------------------------------------------------------------------------------------------------------------------------------------------------------
test10
목록보여주는곳

form action="test11.jsp"  
장바구니에 추가 -> <input type="submit" value="장바구니에 추가하기">


멤버 선언 -> request에서 받아와서 ("mid") -
- <% member %>님, 안녕하세요

얘가 비어있을때만 셋팅을 해주세요 ( if session.getAttribute(member=null) - 이 부분

멤버 등록 해줘야되니까 처음꺼에 ""붙여서 member -> "member"

받은값 session에 저장 - 로그인도 유지될려면 저장해야할듯 장바구니도
session.setAttribute(member, member) - 이렇게 저장



session - 내장객체임~

submit-form당 무조건 1개 
하이퍼 박아서 다른페이지로 한번에 가게
-------------------------------------------------------------------------------------------------------------------------------------------------------------
test 11 
장바구니

장바구니에 추가하는건 순수로직임
추가 완료되면 다시 상품선택 페이지로 넘어감

html이 전혀 필요없음 화면에 보여줄게 없으니까

그래서 위에 test6이나7도 html보여줄 필요 없음

10->11->10
화면에 서비스 되는게 없으니까 html 필요가 없음
response.sendRedirect로 새로운 요청이 없으니까

// ★★★★★★★★★★★★★★★★★
// 장바구니,로그인 유지 여부, 광고 띄우지않기 설정 등 - 설정유지해야되는것들
// 서버가 변경되어도 '브라우저가 유지되고있었다면 설정이 유지되어야하는 상태'에 있는 데이터들을
// "세션(session)"으로 관리!!!
// 일정 시간이 흐르면 연결이 해제됨 - 특징 - (사용자가 브라우저 해지 안눌렀어도 - ex)은행어플 로그인 연장할텨? 같은거)
// 브라우저끼리 값을 공유하지 않는다



-장바구니 한글코딩-
// 사용자가 product라는 이름의 파라미터를 전송할 예정
// 전달받은 상품을 "장바구니"에 추가
// 현재 한글 데이터 전송중 -> 인코딩 필수

// 장바구니를 맨 처음 만드는 경우에는 새로 new
// 기존 장바구니가 있는 경우에는 .add()

// 추가 완료되면 다시 test10.jsp로 이동



주의사항 -> 한글데이터를 보내고 있다는점 (인코딩 해야겠음)

서버가 바뀌더라도 브라우저가 유지되면 장바구니도 유지 되었어야함

브라우저 단위면 예를 들어 엣지랑 크롬이랑 두개 같이 돌려도 세션은 공유되지 않는다.


-----
if(datas==null)   ->   if(datas가 없니?)
즉, 첫번째 상품이니?
ArrayList<String> datas=new ArrayList<String>();

화면 전환되어야 하니까 script 사용

alert() -()안에 뭐가 추가가 되었느냐 - ~~~가 장바구니에 추가되었습니다.
뒤로 돌아가야되니까 history.go(-1);



session내장객체야 니가 가진것 중에 장바구니 주라
↓
ArrayList<String> datas = session.get.getAttribute("datas"); - 형 변환(다운캐스팅) 해줘야됨


session에는 obj로 저장되어있으니까 꺼내서 쓸때마다 다운캐스팅 해줘야한다.

<script>
	alert('<%=product%>이(가) 장바구니에 추가되었습니다! :D');
	history.go(-1);
</script>
history.go(-1) - 1개 전에 페이지로 돌아가게해줘
-------------------------------------------------------------------------------------------------------------------------------------------------------------
test 12 
최종결제

지금까지 산거 다 보여줄꺼임
<h1> 결제 페이지 </h1>
ㅇㅇ님이 결제하신 상품 목록입니다. <br>

session에 저장되어있던 목록 가져와
그리고 보여줘 
↓
ArrayList
if(datas==null) - 아직 상품을 안담아둔거임
장바구니가 비었다는 멘트
for(String v:datas)




test09~12
-------------------------------------------------------------------------------------------------------------------------------------------------------------
실습 1

1.Product VO
int pk
String name
int price
-> 총 가격 출력해주세요
=> 티셔츠 2000
     티셔츠 2000
+) 중복상품이라 장바구니에 넣을수 없습니다.
 +) db

-------------------------------------------------------------------------------------------------------------------------------------------------------------
실습 1 

로그인이랑 목록 보여주는거랑 장바구니랑 최종결제 해서 총 4개 만들고
목록 보여줄때 가격을 붙이고
최종결제 할때 가격 계산하는거를 붙여서 총 가격을 출력?
아니면 저기 product에 박을지 
-------------------------------------------------------------------------------------------------------------------------------------------------------------
실습 1 쌤 풀이
중점 : 어떤페이지에 뭘 배치하는지, 데이터가 어떻게 흘러가는지

------------
a페이지 - 로그인 하세요
로그인
상품 선택공간

마지막 a태그 누르면 결제페이지로 가게 만들기



if(로그인안했어?) -> 세션에 mid값이 안저장되어있어? -> 세션에 mid값이 안저장되어있어?==null이야?
	로그인은 ~~~.jsp에서 진행할것
	로그인 버튼 - 로그인 할려면 아이디 비번 버튼 넣어야함 -> 그걸 감싸줄 form이 필요함
보내는 메서드 안적었으니까 get
else
	로그아웃 버튼 - 로그아웃 할때 필요한 데이터가 없으니까 a태그로 작업함
a태그는 전달방식이 디폴트로 get

if~에서는 자바니까 스크립틀릿 적어줘서 자바영역 확보

-
상품 목록 출력해줄 화면
form action누르면 select로 상품선택
장바구니에 추가하는건 b.jsp
선택하는 이름을 product로 해둔다

for(ProductVO v:datas
DAO에서 셀렉트해서 받아오면 채워둘꺼다

* pDAO없으면 객체화 해준다 - pDAO라는 이름의 객체를 만들어준다
ProductDAO pDAO= new~~~해주는게 - useBean


33~37에 pk 잘 보내는거 다시 보기

-----------
b페이지 - 로그인 화면
로그인하고 메인화면으로 올 예정이라 보여줄 화면 없음
session에 setAttribute할꺼 mid라는 이름으로 저장중

세팅이 완료되면 전 페이지로 갈꺼니까 로그인한 id를 기억해서 전달해야함 - 이걸 session에 저장해서 session이 해주니까

가져가야하는 데이터는 있지만 세션이 해줬으니까 신경써야할 데이터는 없음 ->  redirect 써줌 데이터 유지할거 없으니까


장바구니에 추가하는 로직
한글 코딩 먼저!
// 상품을 받아와서,
// 그걸 장바구니에 추가하고,

// 혹시 장바구니가 없으면?
// 만들어서 넣으면됨

// 사용자에게 ㅁㅁ가 장바구니에 추가되었습니다.
// 다시 메인으로 페이지 이동


--
// 상품을 받아와서, -> requestgetparameter("product")
name+" : "+price+"원"


// 그걸 장바구니에 추가하고, -> 그걸(Product VO) 장바구니에 추가하고,

selectOne으로 비교




== selectOne(PK); => 님들아(V) pk로 주셈!

view는 pk를 잘 주는게 중요



string으로 오는애를 객체로 바꿔야하는게 핵심
== selectOne(); 무조건 이걸로 씀 / 구조 파악하기!



// 혹시 장바구니가 없으면?
// 만들어서 넣으면됨

ArrayList 넣어서 cart에 add해주는거
if (cart == null)
cart=new ArrayList<ProductVO>();

장바구니에 추가되었습니다 띄우고 페이지 이동
alert
location.href='a.jsp';

-------------
e페이지 - 로그아웃

세션의 정보를 지우는 함수 총 3가지 - 비워줘, 지워줘(removeAttribute)(remove), 전부 지워줘(

response.sendRedirect ->데이터 유지할게 없으니까 이걸 써줘서 메인 페이지로 가준다

--------------
productVO
멤버변수가 private이니까 게터세터해준다 갖다 쓸라고

---------------
DAO

selectOne
if(혹시  외부에서 온pk가 내가 가진 pk랑 같아?)

---------------
c페이지 - 결제

ㅇㅇ(session안에 있음 그 로그인 한거)님이 구매한 상품들입니다. 보여줄꺼

li쓸려면 ul이나 ol 있어야함

메인으로 가고 싶으면 하이퍼링크 써서 메인으로 가는거 만들어 주기 a태그로

-------------------------------------------------------------------------------------------------------------------------------------------------------------
내부객체 - 파일안에 이미 선언이 되어있음 ( ex) new 이게 다 되어있다.) 갖다 쓰기만 하면된다.
productVO는 새롭게 만들어줌 - 객체를 만들어줄려고



-------------------------------------------------------------------------------------------------------------------------------------------------------------

b에 장바구니

뷰에서 준 pk 넣어서 pVO에 넣어서 세팅하면 내가 원하는 장바구니가 옴


b페이지 복습하기 - 씨벌 ㅠ



